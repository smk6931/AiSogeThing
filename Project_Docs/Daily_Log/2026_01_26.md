=== 유튜브 구독 시스템 리팩토링 (2026-01-24) ===

1. 기존 문제점
   - 발굴(Discover) 즉시 DB에 저장됨
   - 사용자가 명시적으로 구독 의사를 표현할 수 없음
   - 개인별 구독 리스트 관리 불가

2. 개선 방향
   - 발굴은 임시 결과만 표시 (DB 저장 X)
   - 구독 버튼 클릭 시에만 DB 저장
   - 내 구독 리스트를 별도 UI로 관리

3. DB 구조 변경

   [기존 테이블]
   youtube_channels (공용 채널 정보 캐싱)
     - id (PK)
     - channel_id (YouTube ID, Unique)
     - name (채널명)
     - keywords (발견 키워드)
     - created_at

   [신규 테이블]
   user_subscriptions (개인 구독 관계)
     - id (PK)
     - user_id (FK -> user.id)
     - channel_id (FK -> youtube_channels.id)
     - created_at
     - 제약: (user_id, channel_id) Unique (중복 구독 방지)

4. Backend API 설계

   [발굴 API - 기존 유지, 로직만 변경]
   GET /api/youtube/discover?interest=음악
   - 기능: YouTube API로 채널 검색
   - 변경점: DB에 저장하지 않고 임시 결과만 반환
   - 응답: 채널 리스트 (channel_id, name, thumbnail...)

   [구독하기 API - 신규]
   POST /api/youtube/subscribe
   Body: { channel_id: "UCxxx", channel_name: "채널명" }
   - 기능: 
     1. youtube_channels에 채널 정보 저장 (없으면 생성)
     2. user_subscriptions에 유저-채널 관계 저장
   - 인증: JWT 토큰 필수
   - 응답: { success: true, message: "구독 완료" }

   [구독 취소 API - 신규]
   DELETE /api/youtube/unsubscribe/{channel_id}
   - 기능: user_subscriptions에서 해당 레코드 삭제
   - 응답: { success: true }

   [내 구독 리스트 조회 - 신규]
   GET /api/youtube/my-subscriptions
   - 기능: 현재 유저가 구독한 채널 목록 반환
   - 인증: JWT 토큰 필수
   - 응답: [{ channel_id, name, thumbnail, subscribed_at }, ...]

5. Frontend UI 구조

   [Youtube Lounge 탭 구성]
   - 발굴 탭 (기존 유지, 버튼 추가)
     - 관심사 입력 -> API 호출
     - 채널 카드 표시
     - 각 카드에 "구독하기" 버튼 추가
     - 버튼 클릭 -> POST /subscribe

   - 내 구독 탭 (신규)
     - GET /my-subscriptions 호출
     - 구독 채널 목록 그리드 표시
     - "구독 취소" 버튼

6. 구현 순서
   1단계: DB 모델 추가 (user_subscriptions)
   2단계: Backend API 구현 (subscribe, unsubscribe, my-subscriptions)
   3단계: Alembic 마이그레이션 실행
   4단계: Frontend 컴포넌트 수정 (구독 버튼 + 내 구독 탭)

7. 예상 효과
   - 사용자 의도 명확화 (발굴 != 구독)
   - 개인화된 구독 관리
   - 향후 매칭 알고리즘 기반 데이터 확보
